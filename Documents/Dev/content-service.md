# Content Service

### Мета-информация

Разработчик: Захар, Филипп

Сервис "контента" реализует бизнес-логику приложения: работу с профилями, обработку проектов и их поиск, но не реализует логику аутентификации и авторизации пользователей. Им будут пользоваться как и пользователи, так и админы.

### Техническое задание

1) Сущности приложения:

- __Профиль__ `profiles` - это сущность, содержащая все данные пользователя: имя `first_name`, фамилия `last_name`, отчество `middle_name`, дата рождения `date_birthday`, пол `sex`, город `city`, университет `university`, произвольная биография человека `bio` и навыки `skills`, а также `user_id` и `profile_id`
- __Навыки__ `skill`- это сущность, содержащая информацию о способностях пользователя, например, умение быть коммуникабельным и писать код на Go. `skill` содержит поля: `id`, краткое текстовое описание `tag`, полное описание `description` и поле `category`. 
- __Категория навыков__ `skills_category`- это сущность, определяющая тип навыка. Примеры категориев: "социальные навыки", "web-разработка" и т.д.
- __Проекты__ `projects` - это сущность, реалиюзущая логику "проектов". Пользователь создает проект и предлагает другим вступить в него. Поля: `project_id`, `founder_id` - user_id пользователя основателя проекта, `members` - user_id участников проекта, `name` - имя проекта, `description` - описание проекта (текст в формате markdown), `skills` - требуемые навыки для проекта
- __Заявки__ `applications` - это сущность, реализующая логику вступления в проект. Пользователь будет отправлять заявку основателю проекта. Если основатель ее одобрит, пользователь вступит в проект и в поле `members` появится новый член. Поля: `project_id` - Id проекта, `candidate_id` - user_id кандидата, `message` - небольшое сообщение от кандидата и `status` - поле со статусом заявки: ожидает `PENDING`, принят `APPROVED` или отклонен `REJECTED`

На основе этих следует реализовать модели в БД.

2) API

Сервис должен предоставить RestFull Api для работы с этими сущностями.

Пользовательские методы:

- GET `api/profile` - получить профиль текущего пользовател
- PUT `api/profiles` - обновить профиль текущего пользователя
- POST `api/project` - создать проект
- PUT `api/project` - обновить проект
- DELETE `api/project` - удалить проект
- POST `api/applications` - отправить заявку
- GET `api/applications?project_id=` - получить все заявки в проект
- POST `api/applications/verdict` - принять/отклонить заявку

Админские методы:
- POST `api/admin/skills` - создать навык
- PUT `api/admin/skills` - обновить навык
- DELETE `api/admin/skills` - удалить навык

Общие методы:

- GET `api/profiles` - получить профили пользователей
- GET `api/profiles?user_id=` - получить профиль другого пользователя
- GET `api/skills` - получить список всех навыков
- GET `api/projects` - получить список всех проектов
- GET `api/projects?project_id=` - получить проект по Id


3) Технологии

Реализовать с использованием FastApi и PgSQL

4) Интеграция с другими сервисами:

- Auth-сервис генерирует JWT-токен с полем `user_id` и ролью пользователя `role`: `admin` или `user`. У админов нет и не может быть профиля, проекта и т.п. В завимостимости от роли должен предоставлять доступ к методам API, за исключение "общих методов", доступ к которым имеют все пользователи. Соотвественно, Content-сервис должен парсить токен, проверять его валидность и получать его содержимое. Кроме того, при помощи gRPC Auth-сервис будет отправлять запрос на создание профиля (автоматически после регистрации). gRPC контракт будет написан позже.

- Notification-сервис содержит методы для отправки уведомлений. Работать с ним можно будет при помощи очереди `RabbitMq`. В первой итерации разработки Content-сервис не будет взаимодействовать с этим сервисом. 

